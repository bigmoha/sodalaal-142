import"https://checkout.razorpay.com/v1/checkout.js";import ee from"./PsModal.b5929b7c.js";import oe from"./PsLabel.f618b059.js";import te from"./PsButton.2af859b4.js";import ae from"./PsRadio.8a89bc8f.js";import ne from"./PsRadio2.1f79459d.js";import re from"./PsErrorDialog.d884287b.js";import le from"./PsWarningDialog2.772141bb.js";import se from"./PsIcon.c315e2a2.js";import ie from"./StripePaymentModal.839f68ac.js";import me from"./PaypalPaymentModal.f164e654.js";import pe from"./OfflinePaymentModal.3db0917a.js";import de from"./InputEmailModal.15b78e4e.js";import{u as ce}from"./AppInfoStore.e1ca82ff.js";import{P as fe}from"./PsValueStore.db7005b9.js";import{u as ue}from"./UserStore.6fc60c2b.js";import{u as _e}from"./PackageStore.6c3b77e4.js";import{I as ge}from"./ItemLimitParameterHolder.a3bfbb51.js";import{A as ye}from"./AppInfoParameterHolder.e24d894d.js";import{u as be}from"./LimitAdItemStore.50bfdc11.js";import{b as G}from"./PsApiService.664f5104.js";import{d as ke,i as u,o as k,c as J,b as r,w as t,a as s,f as E,q as P,t as y,g as L,F as Pe,s as ve,n as Se,m as D,B as R,r as _,E as Ie}from"./app.bcb0820c.js";import{P as T}from"./ps_constants.115f3686.js";import{s as Q}from"./inline.d0ef9675.js";import{P as N}from"./PsUtils.eb7a8002.js";import{f as he}from"./format.min.378730c4.js";import{_ as Ce}from"./plugin-vue_export-helper.21dcd24c.js";import"./vue-neat-modal.bb68220d.js";import"./PsLine.115a33c3.js";import"./PsLabelTitle.529f301f.js";import"./stripe.esm.3ed8eaf3.js";import"./PsLabelHeader4.e06a0f87.js";import"./PsLoadingDialog.9586f261.js";import"./dropin.58c78cb4.js";import"./ApiStatus.5720ba0b.js";import"./PsObject.a17ef38f.js";import"./PsSepetetedStore.9a31ac47.js";import"./PsLabelTitle3.65d5f52c.js";import"./PsLabelHeader6.be5597a7.js";import"./OfflinePaymentStore.6c0ea097.js";import"./DefaultIcon.e76b39a5.js";import"./PsInput.e94383d0.js";import"./DefaultPhoto.cc755f93.js";import"./User.450a868b.js";import"./RatingDetail.291ad5d1.js";import"./ProductRelation.4bf64f0e.js";import"./UserListParameterHolder.d110b747.js";import"./Package.5254ef20.js";import"./PaymentInfo.5aa268a0.js";import"./LimitAdTransaction.e736dae3.js";const Ae=ke({name:"LimitItemModal",components:{PsModal:ee,PsIcon:se,PsLabel:oe,PsButton:te,PsErrorDialog:re,PsRadio2:ne,PsRadio:ae,StripePaymentModal:ie,PaypalPaymentModal:me,OfflinePaymentModal:pe,PsWarningDialog2:le,InputEmailModal:de},setup(){const e=u(),a=u(),U=u(),H=u(),Y=u(),V=u(),i=u(),d=u(),g=_e(),v=be(),b=new ge,n=ce(),K=new ye,z=ue(),S=fe().getLoginUserId(),F=u(0),C=u(""),l=u("");async function m(){e.value.toggle(!0),await v.resetPaidAdItemList(S),await g.packageListWithPurchasedCount(S),A();const o=await n.loadAppInfo(K);C.value=o.data.razorKey,o.status==G.SUCCESS?F.value=parseInt(o.data.oneDay,10):F.value=0}function A(){g.packageList!=null&&g.packageList.data!=null&&g.packageList.data.length>0&&(d.value=g.packageList.data[0])}function w(o){if(d.value==null||d.value.paymentInfo==null){Y.value.openModal("",$t("select_package"));return}n.appInfo.data.mobileSetting.is_demo_for_payment==1?i.value.openModal(R("payment__warning_title"),R("payment__confirm_message"),R("payment__ok"),R("credit_card_modal__cancel"),()=>{o=="PAYPAL"?B():o=="STRIPE"?M():o=="RAZOR"?j():o=="PAYSTACK"?Z():o=="OFFLINE"&&W()},()=>{N.log("Cancel")}):o=="PAYPAL"?B():o=="STRIPE"?M():o=="RAZOR"?j():o=="PAYSTACK"?Z():o=="OFFLINE"&&W()}function M(){e.value.toggle(!1),a.value.openModal(()=>{const o=T.PAYMENT_STRIPE_METHOD.toString();c(o)},()=>{N.log("Cancel")})}async function c(o){var f;b.userId=S,b.packageId=(f=d.value.paymentInfo)==null?void 0:f.id,b.paymentMethod=o,b.paymentMethodNounce=localStorage.paymentNonce||"",b.price=d.value.paymentAttributes.price,b.razorId=l.value||"";const p=await g.postPackageBought(S,b);e.value.toggle(!1),p.status==G.ERROR?Y.value.openModal("",g.limititem.message):(localStorage.paymentNonce="",location.reload())}function B(){e.value.toggle(!1),U.value.openModal(()=>{const o=T.PAYMENT_PAYPAL_METHOD.toString();c(o)},()=>{N.log("Cancel")})}async function j(){const p=(await z.loadUser(S)).data,f={key:C.value,name:"Test Company",prefill:{email:p.userEmail,name:p.userName,contact:p.userPhone},theme:{color:"#0e9f6e"},handler:async function(h){l.value=h.razorpay_payment_id,c(T.PAYMENT_RAZOR_METHOD.toString())}},I=new window.Razorpay(f);I.open(),I.on("payment.failed",function(h){})}async function Z(){var I;const p=(await z.loadUser(S)).data;let f=p.userEmail;p.userEmail==""||p.userEmail==null?V.value.openModal(h=>{var O;f=h,Q.setup({key:(O=n==null?void 0:n.appInfo)==null?void 0:O.data.payStackKey,email:f,amount:d.value.price,callback:async function(q){N.log(q),c(T.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()},()=>{console.log("cancel")}):Q.setup({key:(I=n==null?void 0:n.appInfo)==null?void 0:I.data.payStackKey,email:f,amount:d.value.paymentAttributes.price,callback:async function($){N.log($),c(T.PAYMENT_PAY_STACK_METHOD.toString())},onClose:function(){}}).openIframe()}function W(){e.value.toggle(!1),H.value.openModal(()=>{const o=T.PAYMENT_OFFLINE_METHOD.toString();c(o)},()=>{N.log("Cancel")})}function X(o){var p,f,I,h,$,O;return o.toString()=="0"?R("item_price__free"):((I=(f=(p=n==null?void 0:n.appInfo)==null?void 0:p.data)==null?void 0:f.mobileSetting)==null?void 0:I.price_format)==="###,###"?new Intl.NumberFormat("en-FR",{style:"decimal",useGrouping:!0,minimumFractionDigits:0}).format(o).replace(","," "):he((O=($=(h=n==null?void 0:n.appInfo)==null?void 0:h.data)==null?void 0:$.mobileSetting)==null?void 0:O.price_format,o)}return{psmodal:e,openModal:m,packageprovider:g,appInfoStore:n,limitProvider:v,ps_error_dialog:Y,stripe_payment_modal:a,paypal_payment_modal:U,offline_payment_modal:H,selected:d,ps_warning_dialog:i,paymentClicked:w,input_email:V,formatPrice:X}}}),we={class:"flex justify-between items-start"},Ee={class:"flex flex-wrap"},Me={class:"flex flex-col mt-1 sm:mt-7"},Le={class:""},Te={class:"flex flex-col w-full"},Ne={class:"flex flex-col w-full mt-3 gap-2 sm:gap-4",id:"r1"},$e={class:"font-light"},Oe={class:"grid grid-cols-3 sm:grid-cols-3 gap-4 mt-6"},Re={alt:"",class:"w-full h-full object-contain bottom-0"},Ye={alt:"",class:"w-full h-full object-contain bottom-0"},ze={alt:"",class:"w-full h-full object-contain bottom-0"},Fe={alt:"",class:"w-full h-full object-contain bottom-0"},De=P("Offline");function Ue(e,a,U,H,Y,V){const i=_("ps-label"),d=_("ps-icon"),g=_("ps-radio-2"),v=_("ps-button"),b=_("ps-modal"),n=_("stripe-payment-modal"),K=_("paypal-payment-modal"),z=_("ps-warning-dialog-2"),x=_("offline-payment-modal"),S=_("ps-error-dialog"),F=_("input-email-modal"),C=Ie("lazy");return k(),J("div",null,[r(b,{ref:"psmodal",line:"hidden",maxWidth:"534px",isClickOut:!1,class:"h-full",bodyHeight:"max-h-75",theme:"px-4 py-8 sm:p-8 rounded-lg"},{title:t(()=>{var l,m,A,w;return[s("div",we,[((l=e.limitProvider.buyadList)==null?void 0:l.data)!=null&&((w=(A=(m=e.limitProvider.buyadList)==null?void 0:m.data[0])==null?void 0:A.user)==null?void 0:w.remainingPost)==0?(k(),E(i,{key:0,textColor:"text-lg font-semibold text-feSecondary-800 mb-2"},{default:t(()=>[P(y(e.$t("limit_item_modal__quota_running_out.")),1)]),_:1})):L("",!0),s("div",Ee,[r(i,{class:"text-lg text-feSecondary-800 me-2"},{default:t(()=>[P(y(e.$t("limit_item_modal__limit")),1)]),_:1}),r(i,{class:"text-lg"},{default:t(()=>[P(y(e.$t("limit_item_modal__limit_post_buy")),1)]),_:1})]),r(d,{class:"cursor-pointer dark:text-feSecondary-500",name:"close",w:"24",h:"24",onClick:a[0]||(a[0]=M=>e.psmodal.toggle(!1))})])]}),body:t(()=>[s("div",Me,[s("div",Le,[s("div",Te,[r(i,{class:"font-medium text-base"},{default:t(()=>[P(y(e.$t("promote_item_modal__choose_package")),1)]),_:1}),s("div",Ne,[(k(!0),J(Pe,null,ve(e.packageprovider.packageList.data,l=>(k(),E(g,{class:Se(["border px-2 py-2 rounded",{"border-fePrimary-500":e.selected===l}]),key:l.packageId,value:l,selectedValue:e.selected,"onUpdate:selectedValue":a[1]||(a[1]=m=>e.selected=m)},{title:t(()=>[s("div",null,[r(i,{class:"ms-2 pl-1 text-sm font-semibold text-feSecondary-800"},{default:t(()=>[P(y(l.paymentInfo.value),1)]),_:2},1024),r(i,{class:"ms-2 pl-1 mt-1 text-sm text-feSecondary-800"},{default:t(()=>[P(y(l.paymentAttributes.count)+" "+y(e.$t("limit_item_modal__post")),1)]),_:2},1024)])]),price:t(()=>[r(i,{class:"text-sm"},{default:t(()=>{var m;return[s("span",$e,y((m=l.paymentAttributes)==null?void 0:m.currencySymbol),1),P(" "+y(e.formatPrice(l.paymentAttributes.price)),1)]}),_:2},1024)]),_:2},1032,["value","selectedValue","class"]))),128))])])])])]),footer:t(()=>{var l,m,A,w,M;return[r(i,{class:"mt-6 sm:mt-7 font-medium text-base"},{default:t(()=>[P(y(e.$t("promote_item_modal__pay_with")),1)]),_:1}),s("div",Oe,[((l=e.appInfoStore.appInfo.data)==null?void 0:l.paypalEnable)=="1"?(k(),E(v,{key:0,colors:"bg-transparent dark:bg-feSecondary-50",border:"border hover:shadow",hover:"none",class:"",rounded:"rounded-lg",onClick:a[2]||(a[2]=c=>e.paymentClicked("PAYPAL"))},{default:t(()=>[D(s("img",Re,null,512),[[C,{src:e.$page.props.sysImageUrl+"/paypal.png"}]])]),_:1})):L("",!0),((m=e.appInfoStore.appInfo.data)==null?void 0:m.stripeEnable)=="1"?(k(),E(v,{key:1,colors:"bg-transparent  dark:bg-feSecondary-50",border:"border hover:shadow",hover:"none",class:"",rounded:"rounded-lg",onClick:a[3]||(a[3]=c=>e.paymentClicked("STRIPE"))},{default:t(()=>[D(s("img",Ye,null,512),[[C,{src:e.$page.props.sysImageUrl+"/stripe.png"}]])]),_:1})):L("",!0),((A=e.appInfoStore.appInfo.data)==null?void 0:A.razorEnable)=="1"?(k(),E(v,{key:2,colors:"bg-transparent dark:bg-feSecondary-50",border:"border hover:shadow",hover:"none",class:"",rounded:"rounded-lg",onClick:a[4]||(a[4]=c=>e.paymentClicked("RAZOR"))},{default:t(()=>[D(s("img",ze,null,512),[[C,{src:e.$page.props.sysImageUrl+"/razorpay.png"}]])]),_:1})):L("",!0),((w=e.appInfoStore.appInfo.data)==null?void 0:w.payStackEnabled)=="1"?(k(),E(v,{key:3,colors:"bg-transparent dark:bg-feSecondary-50",border:"border hover:shadow",hover:"none",class:"",rounded:"rounded-lg",onClick:a[5]||(a[5]=c=>e.paymentClicked("PAYSTACK"))},{default:t(()=>[D(s("img",Fe,null,512),[[C,{src:e.$page.props.sysImageUrl+"/paystack.png"}]])]),_:1})):L("",!0),((M=e.appInfoStore.appInfo.data)==null?void 0:M.offlineEnabled)=="1"?(k(),E(v,{key:4,colors:"bg-transparent dark:bg-feSecondary-50",class:"",border:"border hover:shadow",hover:"none",padding:"px-8 py-4",rounded:"rounded-lg",onClick:a[6]||(a[6]=c=>e.paymentClicked("OFFLINE"))},{default:t(()=>[r(d,{class:"dark:text-feSecondary-800 pr-1",name:"wallet",w:"20",h:"20"}),r(i,{textColor:" font-semibold"},{default:t(()=>[De]),_:1})]),_:1})):L("",!0)])]}),_:1},512),r(n,{ref:"stripe_payment_modal"},null,512),r(K,{ref:"paypal_payment_modal"},null,512),r(z,{ref:"ps_warning_dialog"},null,512),r(x,{ref:"offline_payment_modal"},null,512),r(S,{ref:"ps_error_dialog"},null,512),r(F,{ref:"input_email"},null,512)])}var Fo=Ce(Ae,[["render",Ue]]);export{Fo as default};
